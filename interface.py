# -*- coding: utf-8 -*-
"""interface.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1SASp312iTXGBGvi9v137TJDOUC-gHKei
"""

import streamlit as st
import pandas as pd
from io import BytesIO
from traitement import traiter_fichier_excel  # Ton code existant ici

st.set_page_config(page_title="Classement Machines", layout="centered")

st.title("ğŸ“Š Classement des donnÃ©es machines")
st.write("Uploadez les fichiers ci-dessous pour gÃ©nÃ©rer le rapport.")

st.sidebar.title("ğŸ“˜ Mode d'emploi")
st.sidebar.markdown("""
1. Cliquer sur "Browse files" pour tÃ©lÃ©charger le fichier Ã  traiter

âš ï¸ Il faut que le fichier s'appelle "Business Unit Groupe 2.xlsx"

2. Cliquer sur "ğŸ§ª Lancer le traitement" pour traiter le fichier

3. Cliquez sur "ğŸ“¥ TÃ©lÃ©charger le fichier classÃ©" pour l'enregistrer sur votre appareil.

âš ï¸ Cet outil n'enregistre pas les fichiers (il faut bien importer Ã  chaque fois)

""")

col1, col2 = st.columns([4, 1])
with col2:
    st.image("logo.png", width=80)

# TÃ©lÃ©versement du fichier principal
uploaded_file = st.file_uploader("ğŸ“ Fichier 'Business Unit Groupe 2.xlsx'", type=["xlsx"])


if uploaded_file:
    if st.button("ğŸ§ª Lancer le traitement"):
        with st.spinner("Traitement en cours..."):

            fichier_sortie = traiter_fichier_excel(uploaded_file)

            st.success("âœ… Traitement terminÃ© !")
            st.download_button(
                label="ğŸ“¥ TÃ©lÃ©charger le fichier classÃ©",
                data=fichier_sortie.getvalue(),
                file_name="Impact_F13.xlsx",
                mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
            )
else:
    st.info("Veuillez tÃ©lÃ©verser le fichier pour commencer.")