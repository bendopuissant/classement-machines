# -*- coding: utf-8 -*-
"""interface 0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1SASp312iTXGBGvi9v137TJDOUC-gHKei
"""

import streamlit as st
import pandas as pd
from io import BytesIO
from traitement_f13 import code_traitement_F13
from traitement_machines import code_traitement_machines

st.set_page_config(page_title="Classement Machines", layout="centered")

col1, col2 = st.columns([3, 1])

with col2:
    st.image("logo.png", width=700)

with col1:
  st.title("ğŸ“Š Classement des donnÃ©es machines")
  st.write("Uploadez les fichiers ci-dessous pour gÃ©nÃ©rer le rapport.")

with st.sidebar :

  st.sidebar.title("ğŸ“˜ Mode d'emploi")
  st.sidebar.markdown("""
  1. Cliquer sur "Browse files" pour tÃ©lÃ©charger le fichier Ã  traiter

  2. Cliquer sur "ğŸ§ª Lancer le traitement F13" ou "ğŸ§ª Lancer le traitement machines" pour traiter en fonction du F13 seulement ou de tous les types d'arrÃªts

  3. Cliquer sur "ğŸ“¥ TÃ©lÃ©charger le fichier classÃ©" pour l'enregistrer sur votre appareil.

  Le fichier contiendra :

  -Une feuille des donnÃ©es complÃ¨tes

  -Un classement des machines par temps d'arrÃªt

  -Une feuille par machine

  -Un rÃ©sumÃ© des causes

  âš ï¸ Cet outil n'enregistre pas les fichiers (il faut bien importer Ã  chaque fois)

  """)

  with st.expander("A propos") :
    st.markdown("""

    J'ai mis au point cet outil dans le cadre d'un stage technicien Ã  Michelin Blanzy du 10/06/2025 au 18/07/2025.

    Il a pour but de faciliter le traitement de donnÃ©es en permettant de crÃ©er un fichier complet classant les donnÃ©es Ã  partir d'un fichier excel rÃ©cupÃ©rÃ© sur MicroStrategy.

    Si vous voulez me remercier pour la crÃ©ation de ce merveilleux outil, voici mon RIB : FR76 1080 7004 6942 4196 7298 767


    BenoÃ®t GUENIN, Ã©tudiant en deuxiÃ¨me annÃ©e Ã  l'Icam Toulouse

    """)

# TÃ©lÃ©versement du fichier principal
uploaded_file = st.file_uploader("ğŸ“ Fichier", type=["xlsx"])


if uploaded_file:
    if st.button("ğŸ§ª Lancer le traitement F13"):
        with st.spinner("Traitement en cours..."):

            fichier_F13 = code_traitement_F13(uploaded_file)

            st.success("âœ… Traitement terminÃ© !")
            st.download_button(
                label="ğŸ“¥ TÃ©lÃ©charger le fichier classÃ©",
                data=fichier_F13.getvalue(),
                file_name="Impact_F13.xlsx",
                mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
            )
    if st.button("ğŸ§ª Lancer le traitement machines"):
        with st.spinner("Traitement en cours..."):

            fichier_machines = code_traitement_machines(uploaded_file)

            st.success("âœ… Traitement terminÃ© !")
            st.download_button(
                label="ğŸ“¥ TÃ©lÃ©charger le fichier classÃ©",
                data=fichier_machines.getvalue(),
                file_name="Impact_machines.xlsx",
                mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
            )
else:
    st.info("Veuillez tÃ©lÃ©verser le fichier pour commencer.")